<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="author" content="Benaissa Ghrib" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>York South&#8211Weston Services</title>

<!--Stylesheet-->

<!--[if IE 7]>
<link rel="stylesheet" href="css/fontello-ie7.css"><![endif]-->

<link href="css/font.css" rel="stylesheet" type="text/css">
<link href="css/fontello.css" rel="stylesheet" type="text/css">
<link href="css/main.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="fancybox/jquery.fancybox-1.3.4.css" />
<link rel="stylesheet" href="css/ui.totop.css" />
<link href="css/jquery.vegas.css" rel="stylesheet" />
<link rel="stylesheet" href="css/leaflet.css"><link rel="stylesheet" href="css/L.Control.Locate.min.css">
<link rel="stylesheet" href="css/qgis2web.css"><link rel="stylesheet" href="css/fontawesome-all.min.css">
<link rel="stylesheet" href="css/MarkerCluster.css">
<link rel="stylesheet" href="css/MarkerCluster.Default.css">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/026c36049d.js" crossorigin="anonymous"></script>
<link rel="stylesheet"
          href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	   <script src="https://kit.fontawesome.com/e1f93e03c9.js"></script>	
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->


<!--[if lt IE 8]>
<style>
/* For IE < 8 (trigger hasLayout) */
.clearfix {
    zoom:1;
}
</style>
<![endif]-->
</head>

<body>

		<!--Full  mask-->	
		<div class="mask"></div>
		<!--End full mask-->
	
<!--Wrapper-->
	<div id="wrapper">
		
		
		<!--Header-->
		<header id="header" class=" default clearfix">
			
			<!--Inner header-->
			<div class="innerHeader">
			<!--Holder 860-->
			<div class="holder860 clearfix">


			<!--Title-->
			<div class="title" style="color:#f1f1f2">
			<h1><span>Hon. Ahmed Hussen</h1>
			</div>
			<!--End title-->


			<!--Navigation-->
				<nav id="mainNav" >
					<a href="tel:+1-416-656-2526" target="_blank" class="mobileBtn"><i class="fas fa-phone"></i></a>
				</nav>
			<!--End navigation-->
				</div>
				<!--End Holder 860-->
				</div>
				<!--End inner header-->
			</header>
			<!--Header-->
			
			
			<!--Teaser-->
			<div id="teaser" class="clearfix">
				
				<!--Holder 860-->
				<div class="holder860 clearfix">
					<!--Profile slider-->
					<div id="profileSlider" class="column">
					<img src="images/headshot_copy2.png" width="160" height="155" alt="">
					
						
						
						
					</div>
					<!--End profile slider-->
					
					<!--Profile info-->
					<div id="profileInfo" class="column" style="color:#f1f1f2;">
						<h1>Hon. Ahmed Hussen</h1>
						<h3>Member of Parliament for York South&#8211Weston</h3>
									
						
					</div>
					
					<!--End profile info-->
					
				</div>
				
				<!--End Holder 860-->	
			</div>
			<!--End teaser-->
			
			
			<!--Quick touch-->
			<div id="quick">
				
				<!--Holder 860-->
				<div class="holder860 clearfix">
				
				<!--Phone and mail-->
				<div class="phoneMail column">
				<span><a href="tel:4166562526"><i class="fas fa-phone"></i>Phone: (416) 565-2526</span></a>
				<span><a href="mailto:ahmed.hussen@parl.gc.ca"><i class="fas fa-envelope"></i>Email: ahmed.hussen@parl.gc.ca</span></a>	
				</div>
				<!--End phone and mail-->
				
				
				<!--Socials-->
				<div class="socials column">
					<!--Socials-->
					<ul>
						
						<li><a href="https://twitter.com/HonAhmedHussen"><i class="fab fa-twitter"></i></a></li>
						<li><a href="https://www.facebook.com/HonAhmedHussen/"><i class="fab fa-facebook"></i></a></li>
						<li><a href="https://www.instagram.com/ahmeddhussen/"><i class="fab fa-instagram"></i></a></li>
					</ul>
					<!--End socials-->
				</div>
				<!--End socials-->
				
				</div>
				<!--End Holder 860-->
			</div>
			<!--End quick touch-->
			
			
			
			<!--About section-->
			<section id="about" class="clearfix section">
				
				<!--Holder 860-->
				<div class="holder860 clearfix">
				<!--Title-->
				<div class="secTitle">
					<i class="icon-up-micro"></i>
					<h1>York South&#8211Weston Services</h1>
				</div>
				<!--End title-->
				
				<!--MAP HERE-->
<div id="map">
        </div>
        <script src="js/qgis2web_expressions.js"></script>
        <script src="js/leaflet.js"></script><script src="js/L.Control.Locate.min.js"></script>
        <script src="js/leaflet.rotatedMarker.js"></script>
        <script src="js/leaflet.pattern.js"></script>
        <script src="js/leaflet-hash.js"></script>
        <script src="js/Autolinker.min.js"></script>
        <script src="js/rbush.min.js"></script>
        <script src="js/labelgun.min.js"></script>
        <script src="js/labels.js"></script>
        <script src="data/OfficeAdditions_1.js"></script>
        <script src="data/YouthServices_2.js"></script>
        <script>
        var map = L.map('map', {
            zoomControl:true, maxZoom:28, minZoom:1
        }).fitBounds([[43.67459680375241,-79.53099641425088],[43.7284010320873,-79.42531296625681]]);
        var hash = new L.Hash(map);
        map.attributionControl.setPrefix('Developed by the Office of Hon. Ahmed Hussen');
        var autolinker = new Autolinker({truncate: {length: 30, location: 'smart'}});
        L.control.locate({locateOptions: {maxZoom: 19}}).addTo(map);
        var bounds_group = new L.featureGroup([]);
        function setBounds() {
            map.setMaxBounds(map.getBounds());
        }
        map.createPane('pane_GoogleMaps_0');
        map.getPane('pane_GoogleMaps_0').style.zIndex = 400;
        var layer_GoogleMaps_0 = L.tileLayer('http://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
            pane: 'pane_GoogleMaps_0',
            opacity: 1.0,
            attribution: '',
            minZoom: 1,
            maxZoom: 28,
            minNativeZoom: 0,
            maxNativeZoom: 22
        });
        layer_GoogleMaps_0;
        map.addLayer(layer_GoogleMaps_0);
        function pop_OfficeAdditions_1(feature, layer) {
            var popupContent = '<table>\
                    <tr>\
                        <th scope="row">Agency Name</th>\
                        <td>' + (feature.properties['Agency Nam'] !== null ? autolinker.link(feature.properties['Agency Nam'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Phone Number</th>\
                        <td>' + (feature.properties['Office Pho'] !== null ? autolinker.link(feature.properties['Office Pho'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Website</th>\
                        <td>' + (feature.properties['Website'] !== null ? autolinker.link(feature.properties['Website'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Languages</th>\
                        <td>' + (feature.properties['Languages'] !== null ? autolinker.link(feature.properties['Languages'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Hours</th>\
                        <td>' + (feature.properties['Hours'] !== null ? autolinker.link(feature.properties['Hours'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Services</th>\
                        <td>' + (feature.properties['Programs'] !== null ? autolinker.link(feature.properties['Programs'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            layer.bindPopup(popupContent, {maxHeight: 400});
        }

        function style_OfficeAdditions_1_0() {
            return {
                pane: 'pane_OfficeAdditions_1',
                radius: 6.4,
                opacity: 1,
                color: 'rgba(128,17,25,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 2.0,
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(219,30,42,1.0)',
                interactive: true,
            }
        }
        map.createPane('pane_OfficeAdditions_1');
        map.getPane('pane_OfficeAdditions_1').style.zIndex = 401;
        map.getPane('pane_OfficeAdditions_1').style['mix-blend-mode'] = 'normal';
        var layer_OfficeAdditions_1 = new L.geoJson(json_OfficeAdditions_1, {
            attribution: '',
            interactive: true,
            dataVar: 'json_OfficeAdditions_1',
            layerName: 'layer_OfficeAdditions_1',
            pane: 'pane_OfficeAdditions_1',
            onEachFeature: pop_OfficeAdditions_1,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.circleMarker(latlng, style_OfficeAdditions_1_0(feature));
            },
        });
        bounds_group.addLayer(layer_OfficeAdditions_1);
        map.addLayer(layer_OfficeAdditions_1);
        function pop_YouthServices_2(feature, layer) {
            var popupContent = '<table>\
                    <tr>\
                        <th scope="row">Agency Name</th>\
                        <td>' + (feature.properties['AGENCY_NAM'] !== null ? autolinker.link(feature.properties['AGENCY_NAM'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Organization</th>\
                        <td>' + (feature.properties['ORGANIZATI'] !== null ? autolinker.link(feature.properties['ORGANIZATI'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Neighbourhood</th>\
                        <td>' + (feature.properties['NEIGHBOURH'] !== null ? autolinker.link(feature.properties['NEIGHBOURH'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Phone</th>\
                        <td>' + (feature.properties['OFFICE_PHO'] !== null ? autolinker.link(feature.properties['OFFICE_PHO'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Email</th>\
                        <td>' + (feature.properties['EMAIL'] !== null ? autolinker.link(feature.properties['EMAIL'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Website</th>\
                        <td>' + (feature.properties['WEBSITE'] !== null ? autolinker.link(feature.properties['WEBSITE'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Languages</th>\
                        <td>' + (feature.properties['LANGUAGES'] !== null ? autolinker.link(feature.properties['LANGUAGES'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Accessibility</th>\
                        <td>' + (feature.properties['ACCESSIBIL'] !== null ? autolinker.link(feature.properties['ACCESSIBIL'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Hours</th>\
                        <td>' + (feature.properties['HOURS'] !== null ? autolinker.link(feature.properties['HOURS'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            layer.bindPopup(popupContent, {maxHeight: 400});
        }

        function style_YouthServices_2_0() {
            return {
                pane: 'pane_YouthServices_2',
                radius: 6.399999999999999,
                opacity: 1,
                color: 'rgba(128,17,25,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 2.0,
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(219,30,42,1.0)',
                interactive: true,
            }
        }
        map.createPane('pane_YouthServices_2');
        map.getPane('pane_YouthServices_2').style.zIndex = 402;
        map.getPane('pane_YouthServices_2').style['mix-blend-mode'] = 'normal';
        var layer_YouthServices_2 = new L.geoJson(json_YouthServices_2, {
            attribution: '',
            interactive: true,
            dataVar: 'json_YouthServices_2',
            layerName: 'layer_YouthServices_2',
            pane: 'pane_YouthServices_2',
            onEachFeature: pop_YouthServices_2,
            pointToLayer: function (feature, latlng) {
                var context = {
                    feature: feature,
                    variables: {}
                };
                return L.circleMarker(latlng, style_YouthServices_2_0(feature));
            },
        });
        bounds_group.addLayer(layer_YouthServices_2);
        map.addLayer(layer_YouthServices_2);
        setBounds();
        </script>
					
				<!--END OF MAP------------------------------------------------------->
				
				</div>
			<!-- Table__------------------>


<div class="container">
    
    
            <!-- Grid column -->

            
                <h1 style="text-align:center; font-family: Oswald; font-size: 2em;">York South&#8211Weston Services Search</h1>
                <br>
                <div class="row" id="box">
                    <div class="col-11">
                        <form onsubmit="userAction()" action="javascript:">
                            <input type="text" onsubmit="userAction()" autocomplete="off" id="myInput" class="form-control" placeholder="search services... (e.g., food bank, healthcare, etc.)" aria-label="Search" style="font-size: 1em; border:none">
                        </form>
                    </div>
                    <!-- <div class="col-1">
                        <span><i class="fa fa-search" aria-hidden="true" onclick="userAction()" ></i></span>
                    </div> -->
                </div>
            <br>
        

    <div>
        <p id="results"></p>
    </div>

</div>
<script>
    function userAction(){
        let searchString = document.getElementById("myInput").value;
        let txt = "";
        console.log(searchString);
        
        //----------------- MODIFY WEBHOOK_URL BELOW ------------------------

        let webhook_url = "https://webhooks.mongodb-realm.com/api/client/v2.0/app/ysw_services_search-gnngl/service/ysw_services_web_search/incoming_webhook/getTOPIC";
    
        let url = webhook_url + "?arg=" + searchString;

        fetch(url)
            .then(function (response) {
                if(!response.ok){
                    console.log(response);
                    txt += `<br><br><br><b>Sadly you have an error. Status: ${response.status}`;
                    if (response.json.length === 0)
                        txt+=`<br><br>Make sure to search for some type of services. Don't leave your search box empty.</b>`;
                    document.getElementById("results").innerHTML = txt;
                    throw Error(response.statusText);
                }
                return response.json();
            })
            .then(function (movieJSON) {
                if (movieJSON["$undefined"] === true) {
                    console.log('NO FETCH RESULT');
                    txt += `<br><br><br><b>No Fetch</b>`;
                } else {
                    console.log("FETCHED RESULT... "  );
                    if (movieJSON.length !== 0) {
                        console.log("Fetched array has " + movieJSON.length + " entries");
                        txt = buildMovieList(movieJSON);
                    } else {
                        console.log("Fetched array has " + movieJSON.length + " entries");
                        txt += `<br><br><br><b>Sadly you have no search results. Try checking your spelling or contacting our <a href="mailto:ahmed.hussen@parl.gc.ca">office </a>to add this service to our database</b>`;
                    }
                }  // end of ELSE

            document.getElementById("results").innerHTML = txt;
        }).catch(function(error){
            console.log('Whoopsie! - error', error);
        });
    }

    function buildMovieList(services){
        // HELPER FUNCTION FOR USER ACTION
        
        let i = 0;      // for number of movie documents returned
        let j = 0;      // for number of highlight entries
        let k = 0;      // for highlight.texts type entries - either "hit" or "text"
        let highlight_length = 0;
        let txt = "";
        
        for (i; i < services.length; i++) {

            txt += `<b>${services[i].AGENCY_NAM } </b><br>`;
            txt += `Address: ${services[i].ORGANIZATI} <br>`;
            txt += `Phone: ${services[i].OFFICE_PHO} <br>`;
            txt += `Email: ${services[i].EMAIL} <br>`;
            txt += `Website: ${services[i].WEBSITE} <br>`;
            txt += `Languages: ${services[i].LANGUAGES} <br>`;
            txt += `Hours: ${services[i].HOURS} <br>`;
            txt += `Sacha's Search Score (beta):  ${services[i].score["$numberDouble"]} <br>`;

            // BUILD OUT HIGHLIGHTS FROM FULLPLOT FIELD
            for (j = 0; j < highlight_length; j++) {
                for (k = 0; k < services[i].highlight[j].texts.length; k++) {
                    if (services[i].highlight[j].texts[k].type === "hit") {
                        txt += `<b><span style="background-color: #FFFF00"> ${services[i].highlight[j].texts[k].value} </span></b>`;
                    } else {
                        txt += services[i].highlight[j].texts[k].value;
                    }
                } // end of k
            }  // end of j

            txt += "<hr>";
        }
        return txt;
    }
</script>

				
				</div>
				<!--End Holder 860-->
				
			</section>
			<!--End about section-->
			


	
	
				

					</section>	
					<!--End contact section-->
					
					
					
					<!--Footer-->
				<footer id="footer">
						<div class="holder860 clearfix">
							<p>&copy; 2021. Hon. Ahmed Hussen</p>

								<!--Socials footer-->
								<ul class="socialsFooter">

                                    <li><a href="https://twitter.com/HonAhmedHussen"><i class="fab fa-twitter"></i></a></li>
                                    <li><a href="https://www.facebook.com/HonAhmedHussen/"><i class="fab fa-facebook"></i></a></li>
                                    <li><a href="https://www.instagram.com/ahmeddhussen/"><i class="fab fa-instagram"></i></a></li>
								</ul>
								<!--End socials footer-->
								</div>
						</footer>
				<!--End footer-->
					
	
			
	</div>
<!--Edd wrapper-->	
	
<!--Javascript-->
<script src="js/jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="js/jquery-migrate-1.2.1.js"></script>
<script src="js/jquery.easing.1.3.js" type="text/javascript"></script>
<script src="js/jquery.vegas.js" type="text/javascript" ></script>
<script src="js/jquery.quicksand.js" type="text/javascript"></script>
<script src="js/jquery.fancybox-1.3.4.js" type="text/javascript"></script>
<script src="js/jquery.mousewheel.js" type="text/javascript"></script>
<script src="js/slides.min.jquery.js" type="text/javascript"></script>
<script src="js/jquery.scrollTo-min.js" type="text/javascript"></script>
<script src="js/waypoints.js" type="text/javascript"></script>
<script src="js/jquery.tweet.js" type="text/javascript"></script>
<script src="js/jquery.ui.totop.min.js" type="text/javascript"></script>
<script src="js/script.js" type="text/javascript"></script>
<script src="js/gmaps.js" type="text/javascript"></script>




<script>
</script>

</body>
</html>lettering.js" type="text/javascript"></script>
        <script src="js/jquery.textillate.js" type="text/javascript"></script>
        <script src="js/general-lettering.js" type="text/javascript"></script>
        <script src="js/jquery.sliphover.min.js"></script>
        <script src="js/custom.js"></script>
        <!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</body>

</html>
